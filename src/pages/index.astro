---
import Layout from '../layouts/Layout.astro';
import { Badge } from '@/components/ui/badge';
import { Separator } from '@/components/ui/separator';
import { InstallCycler } from '@/components/InstallCycler';
import { getNpmVersion, getPypiVersion } from '@/lib/versions';

const [electronVersion, kdenliveVersion] = await Promise.all([
  getNpmVersion('@harnessgg/electron', '0.1.0'),
  getPypiVersion('harness-kdenlive', '0.3.0'),
]);

const packages = [
  {
    name: '@harnessgg/electron',
    version: electronVersion,
    description: 'Interact with any Electron app via Chrome DevTools Protocol. Click, type, screenshot, assert. Structured JSON output.',
    href: '/electron',
    status: 'published',
  },
  {
    name: 'harness-kdenlive',
    version: kdenliveVersion,
    description: 'Harness the Kdenlive video editor. Create projects, edit timelines, apply effects, and render. Structured JSON output.',
    href: '/kdenlive',
    status: 'published',
  },
  {
    name: '@harnessgg/web',
    version: null,
    description: 'Harness web browsers for AI agents. Automate tabs, navigation, DOM interaction, and screenshots via a CLI with structured JSON output.',
    href: null,
    status: 'soon',
  },
  {
    name: 'harnessgg-blender',
    version: null,
    description: 'Harness the Blender 3D suite. Script scenes, objects, materials, and renders from the CLI with structured JSON output.',
    href: null,
    status: 'soon',
  },
  {
    name: 'harnessgg-gimp',
    version: null,
    description: 'Harness GIMP for image editing. Apply filters, adjustments, and exports programmatically with structured JSON output.',
    href: null,
    status: 'soon',
  },
];
---

<Layout title="Harness.gg: CLI Tools for AI Agents">

  <!-- HERO -->
  <section class="pt-24 pb-20 max-w-[840px] mx-auto px-6">
    <h1 class="hero-heading"> Give AI agents hands
    </h1>

    <p class="hero-sub">
            Open source CLI tools that let AI agents control desktop apps
      <br />
      No MCP. No setup. Just install and go.

    </p>

    <div class="hero-actions">
      <InstallCycler client:load />
      <span class="hero-meta">Open source &middot; MIT</span>
    </div>
  </section>

  <Separator />

  <!-- PACKAGES -->
  <section class="py-16 max-w-[840px] mx-auto px-6" id="packages">
    <p class="text-[0.78rem] font-semibold tracking-widest text-primary mb-6 uppercase">Packages</p>

    <ul class="divide-y divide-border">
      {packages.map(pkg => (
        <li>
          {pkg.href ? (
            <a
              href={pkg.href}
              class="group flex items-center justify-between gap-6 py-5 no-underline hover:no-underline"
            >
              <div class="flex flex-col gap-1.5 min-w-0">
                <code class="font-mono text-[0.95rem] font-medium text-foreground group-hover:text-primary transition-colors">
                  {pkg.name}
                </code>
                <span class="text-[0.84rem] text-muted-foreground leading-relaxed">{pkg.description}</span>
              </div>
              <div class="flex items-center gap-2.5 shrink-0">
                <Badge variant="outline" className="font-mono text-[0.7rem] text-muted-foreground">v{pkg.version}</Badge>
                <Badge className="text-[0.7rem] bg-primary/10 text-primary border-0 hover:bg-primary/15">Published</Badge>
                <span class="text-primary text-base transition-transform group-hover:translate-x-1">&rarr;</span>
              </div>
            </a>
          ) : (
            <div class="flex items-center justify-between gap-6 py-5 opacity-45">
              <div class="flex flex-col gap-1.5 min-w-0">
                <code class="font-mono text-[0.95rem] font-medium text-foreground">{pkg.name}</code>
                <span class="text-[0.84rem] text-muted-foreground leading-relaxed">{pkg.description}</span>
              </div>
              <div class="shrink-0">
                <Badge variant="secondary" className="text-[0.7rem]">Soon</Badge>
              </div>
            </div>
          )}
        </li>
      ))}
    </ul>
  </section>

  <Separator />

  <!-- DISCOVERY -->
  <section class="py-12 max-w-[840px] mx-auto px-6">
    <p class="text-[0.78rem] font-semibold tracking-widest text-primary mb-4 uppercase">For AI agents</p>
    <div class="flex items-center gap-3 flex-wrap">
      <a href="/llms.txt" class="font-mono text-[0.82rem] text-muted-foreground hover:text-primary transition-colors no-underline">/llms.txt</a>
      <span class="text-border text-sm">&middot;</span>
      <a href="/packages.json" class="font-mono text-[0.82rem] text-muted-foreground hover:text-primary transition-colors no-underline">/packages.json</a>
      <span class="text-border text-sm">&middot;</span>
<span class="font-mono text-[0.82rem] text-muted-foreground" title="Agents can submit bug reports and feature requests">
  POST /api/submit (issue reports)
</span>
    </div>
  </section>

</Layout>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Source+Serif+4:wght@400;700&display=swap');

  .hero-heading {
    font-family: 'Source Serif 4', Georgia, serif;
    font-size: clamp(2.6rem, 6.5vw, 3.8rem);
    font-weight: 700;
    line-height: 1.1;
    letter-spacing: -0.02em;
    color: var(--foreground);
    margin-bottom: 1.5rem;
  }

  .hero-sub {
    font-size: 1.05rem;
    color: var(--muted-foreground);
    max-width: 500px;
    line-height: 1.8;
    margin-bottom: 2rem;
  }

  .hero-actions {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    flex-wrap: wrap;
  }

  .hero-meta {
    font-size: 0.82rem;
    color: var(--muted-foreground);
  }
</style>
